--- 
title: "Tour de l'Abitibi 2023 - Technical Guide"
author: "Bruno Gauthier"
institute: "Tour de l'Abitibi"
date: "Last update : `r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
toc-title: "Contents"
#papersize: letter
#fontsize: 12pt
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
    Technical guide for the 2023 Tour de l'Abitibi, a stage of the UCI Nations Cup.
    Presentation of the program, courses and regulations for the event.
suppress-bibliography: yes
params:
  annee: 2023
  dates_compl: "July 11 to 16, 2023"
  ville: "Amos"
  langue: "EN"  # FR ou EN
  sponsor: ""
  input_output : "output"  #Quel dossier pour afficher les cartes des tracés : Full, Dep, Arr.

#link-citations: yes
#github-repo: rstudio/bookdown-demo
---

# Presentation

```{r here, include=FALSE}
# Gestion avec here
here::i_am("guide2023.Rproj")
```

```{r call_Libs_Vars, include=FALSE}
# Appel des librairies et variables partagées
source(here::here("code","_LibsVars.R"))

# Dates
source(here("code", "_Dates.R"))

# Pour accès aux données du fichier excel Itineraires.xlsx
source(here("code","_import_itineraire.R"))

# Pour accès aux tracés et aux POI d'étapes
parcours <- st_read(here("gpx","output","parcours.shp"))%>% 
  mutate(name = str_replace(name, "Étape", "Stage"),
                name = str_replace(name, "CLMI", "ITT"))
points <- st_read(here("gpx","output","points_parcours.shp"))

# Langue
lang <- params$langue

# Edition  (52e en 2022)
edition <-params$annee - 2022 + 52

# Locale
## https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/locales
{if (lang == "FR") Sys.setlocale("LC_TIME", locale = "fr_CA.UTF-8") 
  else Sys.setlocale("LC_TIME", locale = "en_US.UTF-8") }

opts_chunk$set( tidy = FALSE, comment = NA,
                fig.align = "center",
                fig.width = 7.5, fig.height = 7.5,
                fig.retina = 2, cache = FALSE,
                class.output = "codeout",
                warning = FALSE,
                message = FALSE,
                quiet=TRUE)

```


Welcome to the **`r params$annee` Tour de l'Abitibi `r params$sponsor`** !

Here's a preview of the Tour de l'Abitibi `r params$sponsor` `r edition`th edition,  which will be held from `r dates_EN %>% filter(code=="Mar") %>% pull(jsem_jour_mois_an)` to `r dates_EN %>% filter(code=="Dim") %>% pull(jsem_jour_mois_an)`.

<br/>

```{r map_globale, echo = FALSE, eval = TRUE}
# Visualisation
mapview(parcours ,
        lwd = 2.5,
        alpha = 0.7,
        z = "name",
        color = palette.colors(n=7, palette="ggplot2"),
        layer.name = "Stage")
```
